# é˜¶æ®µå…­ï¼šå…¼å®¹æ€§æµ‹è¯• - å®¡æŸ¥æŠ¥å‘Š

**å®¡æŸ¥æ—¥æœŸ**: 2025-12-26  
**é¡¹ç›®**: Immersa 3D Web

---

## 1. æµè§ˆå™¨å…¼å®¹æ€§

### ç›®æ ‡æµè§ˆå™¨

| æµè§ˆå™¨        | æœ€ä½ç‰ˆæœ¬ | WebGL 2.0 | WebGPU  | çŠ¶æ€        |
| ------------- | -------- | --------- | ------- | ----------- |
| Chrome        | 90+      | âœ…        | âœ…      | âœ… ä¸»è¦æ”¯æŒ |
| Edge          | 90+      | âœ…        | âœ…      | âœ… æ”¯æŒ     |
| Firefox       | 89+      | âœ…        | ğŸŸ¡ å®éªŒ | âœ… æ”¯æŒ     |
| Safari        | 15+      | âœ…        | ğŸŸ¡ å®éªŒ | âš ï¸ éƒ¨åˆ†æ”¯æŒ |
| Mobile Chrome | 90+      | âœ…        | âŒ      | âš ï¸ æ€§èƒ½å—é™ |
| Mobile Safari | 15+      | âœ…        | âŒ      | âš ï¸ æ€§èƒ½å—é™ |

### æ„å»ºç›®æ ‡

```javascript
// vite.config.js
build: {
  target: 'esnext',  // ä»…æ”¯æŒæœ€æ–°æµè§ˆå™¨
}
```

> âš ï¸ **æ³¨æ„**: `esnext` ç›®æ ‡ä¸æ”¯æŒæ—§ç‰ˆæµè§ˆå™¨ã€‚å¦‚éœ€æ›´å¹¿æ³›æ”¯æŒï¼Œåº”æ”¹ä¸º `es2020` æˆ– `es2019`ã€‚

---

## 2. WebGL/WebGPU æ”¯æŒæ£€æµ‹

### æ£€æµ‹æœºåˆ¶

é¡¹ç›®å·²å®ç°å®Œæ•´çš„å›¾å½¢åç«¯æ£€æµ‹å’Œé™çº§æœºåˆ¶ï¼š

```javascript
// main.js - èƒ½åŠ›æ£€æµ‹
capabilities.webgpu = await navigator.gpu.requestAdapter();
capabilities.webgl2 = !!canvas.getContext('webgl2');
capabilities.webgl = !!canvas.getContext('webgl');
```

### é™çº§ä¼˜å…ˆçº§

```
WebGPU â†’ WebGL 2.0 â†’ WebGL 1.0 â†’ æ— æ”¯æŒ
```

### çŠ¶æ€æ˜¾ç¤º

| åç«¯      | çŠ¶æ€æ æ˜¾ç¤º   |
| --------- | ------------ |
| WebGPU    | "WebGPU"     |
| WebGL 2.0 | "WebGL 2.0"  |
| WebGL 1.0 | "WebGL 1.0"  |
| æ— æ”¯æŒ    | "æ—  3D æ”¯æŒ" |

### é”™è¯¯å¤„ç†

```javascript
// ErrorHandler.js
canvas.addEventListener('webglcontextlost', (event) => {
  event.preventDefault();
  this.handle(new AppError('WebGL ä¸Šä¸‹æ–‡ä¸¢å¤±', ErrorType.WEBGL, ErrorLevel.FATAL));
});
```

âœ… **WebGL ä¸Šä¸‹æ–‡ä¸¢å¤±å¤„ç†å·²å®ç°**

---

## 3. å“åº”å¼è®¾è®¡

### æ–­ç‚¹é…ç½®

| æ–­ç‚¹   | å®½åº¦     | å˜åŒ–                       |
| ------ | -------- | -------------------------- |
| æ¡Œé¢   | > 1200px | å®Œæ•´å¸ƒå±€                   |
| å¹³æ¿   | â‰¤ 1200px | ä¾§è¾¹æ å˜çª„ (220px)         |
| å°å¹³æ¿ | â‰¤ 900px  | å·¦ä¾§è¾¹æ éšè—               |
| æ‰‹æœº   | â‰¤ 600px  | å³ä¾§è¾¹æ éšè—ï¼Œå¯¼èˆªèœå•éšè— |

### CSS å®ç°

```css
@media (max-width: 1200px) {
  :root {
    --sidebar-width: 220px;
  }
}

@media (max-width: 900px) {
  .sidebar--left {
    display: none;
  }
  :root {
    --sidebar-width: 200px;
  }
}

@media (max-width: 600px) {
  .sidebar--right {
    display: none;
  }
  .navbar__menu {
    display: none;
  }
}
```

### è¯„ä¼°

| ç»´åº¦     | è¯„åˆ†     | è¯´æ˜                    |
| -------- | -------- | ----------------------- |
| æ–­ç‚¹è¦†ç›– | â­â­â­â­ | 3 ä¸ªæ–­ç‚¹ï¼Œè¦†ç›–ä¸»è¦è®¾å¤‡  |
| å¸ƒå±€é€‚åº” | â­â­â­   | ä¾§è¾¹æ éšè—ï¼Œä½†æ— æ›¿ä»£ UI |
| è§¦æ‘¸é€‚é… | â­â­     | æœªè§ä¸“é—¨è§¦æ‘¸ä¼˜åŒ–        |

---

## 4. è§¦æ‘¸è®¾å¤‡æ”¯æŒ

### å½“å‰çŠ¶æ€

| åŠŸèƒ½         | æ”¯æŒ    | è¯´æ˜                   |
| ------------ | ------- | ---------------------- |
| è§¦æ‘¸æ‹–æ‹½ä¸Šä¼  | âš ï¸ æœªçŸ¥ | éœ€æµ‹è¯•                 |
| è§¦æ‘¸ 3D äº¤äº’ | âœ…      | OrbitControls æ”¯æŒè§¦æ‘¸ |
| è§¦æ‘¸æ‰‹åŠ¿     | âš ï¸ æœ‰é™ | æ— è‡ªå®šä¹‰æ‰‹åŠ¿           |
| è™šæ‹Ÿé”®ç›˜     | âš ï¸ æœªçŸ¥ | éœ€æµ‹è¯•                 |

### å»ºè®®æ”¹è¿›

1. **æ·»åŠ è§¦æ‘¸å‹å¥½çš„æŒ‰é’®å°ºå¯¸**

   ```css
   @media (hover: none) and (pointer: coarse) {
     .toolbar__btn {
       min-width: 44px;
       min-height: 44px;
     }
   }
   ```

2. **æ·»åŠ ç§»åŠ¨ç«¯æ±‰å ¡èœå•**
   - æ›¿ä»£éšè—çš„å¯¼èˆªèœå•

---

## 5. PWA ç¦»çº¿æ”¯æŒ

### å½“å‰é…ç½®

| åŠŸèƒ½             | çŠ¶æ€      |
| ---------------- | --------- |
| Service Worker   | âœ… å·²é…ç½® |
| Web App Manifest | âœ… å·²é…ç½® |
| ç¦»çº¿ç¼“å­˜         | âœ… å·²é…ç½® |
| å®‰è£…æç¤º         | âš ï¸ æœªçŸ¥   |

### Workbox é…ç½®

```javascript
// vite.config.js
workbox: {
  globPatterns: ['**/*.{js,css,html,ico,png,svg,woff2}'],
  runtimeCaching: [
    // Google Fonts ç¼“å­˜ (1å¹´)
    { urlPattern: /fonts\.googleapis\.com/, handler: 'CacheFirst' },
    // AI æ¨¡å‹ç¼“å­˜ (30å¤©)
    { urlPattern: /\.(?:onnx|bin|json)$/, handler: 'CacheFirst' }
  ]
}
```

---

## 6. JavaScript ç‰¹æ€§å…¼å®¹

### ä½¿ç”¨çš„ç°ä»£ç‰¹æ€§

| ç‰¹æ€§                     | æ”¯æŒç‡ | çŠ¶æ€ |
| ------------------------ | ------ | ---- |
| ES Modules               | 95%+   | âœ…   |
| async/await              | 95%+   | âœ…   |
| Optional Chaining (?.)   | 93%+   | âœ…   |
| Nullish Coalescing (??)  | 93%+   | âœ…   |
| Private Class Fields (#) | 90%+   | âš ï¸   |
| Top-level await          | 87%+   | âš ï¸   |

### Polyfill éœ€æ±‚

å½“å‰æœªé…ç½® polyfillã€‚å¦‚éœ€æ”¯æŒ Safari 14 æˆ–æ›´æ—©ç‰ˆæœ¬ï¼Œå»ºè®®æ·»åŠ ï¼š

```bash
npm install core-js
```

```javascript
// main.js
import 'core-js/stable';
```

---

## 7. é—®é¢˜æ±‡æ€»

### ä¸¥é‡ç¨‹åº¦åˆ†ç±»

| çº§åˆ«  | é—®é¢˜           | è¯´æ˜              |
| ----- | -------------- | ----------------- |
| ğŸŸ¡ ä¸­ | ç§»åŠ¨ç«¯ UI éšè— | ä¾§è¾¹æ éšè—æ— æ›¿ä»£  |
| ğŸŸ¡ ä¸­ | è§¦æ‘¸é€‚é…ä¸è¶³   | æŒ‰é’®å¯èƒ½è¿‡å°      |
| ğŸŸ¢ ä½ | æ—  polyfill    | æ—§æµè§ˆå™¨ä¸æ”¯æŒ    |
| ğŸŸ¢ ä½ | æ„å»ºç›®æ ‡è¿‡æ–°   | esnext é™åˆ¶å…¼å®¹æ€§ |

---

## 8. ä¼˜åŒ–å»ºè®®æ±‡æ€»

### ç«‹å³ä¿®å¤ (P0)

1. **æ·»åŠ ç§»åŠ¨ç«¯æ›¿ä»£ UI**
   - æ±‰å ¡èœå•æ›¿ä»£éšè—çš„å¯¼èˆª
   - åº•éƒ¨å·¥å…·æ æ›¿ä»£éšè—çš„ä¾§è¾¹æ 

### çŸ­æœŸä¼˜åŒ– (P1)

2. **ä¼˜åŒ–è§¦æ‘¸ç›®æ ‡**

   ```css
   @media (pointer: coarse) {
     .toolbar__btn {
       min-width: 44px;
       min-height: 44px;
     }
   }
   ```

3. **æ”¹è¿› 3D è§†å£ç§»åŠ¨é€‚é…**
   - æ·»åŠ è§¦æ‘¸æ‰‹åŠ¿æç¤º

### é•¿æœŸä¼˜åŒ– (P2)

4. **æ·»åŠ æµè§ˆå™¨å…¼å®¹æ€§æ£€æµ‹**

   - åœ¨ä¸æ”¯æŒçš„æµè§ˆå™¨æ˜¾ç¤ºå‹å¥½æç¤º

5. **è€ƒè™‘é™ä½æ„å»ºç›®æ ‡**
   ```javascript
   build: {
     target: 'es2020';
   }
   ```

---

## 9. é˜¶æ®µå…­ç»“è®º

| ç»´åº¦           | è¯„åˆ†             | è¯´æ˜                 |
| -------------- | ---------------- | -------------------- |
| **WebGL æ”¯æŒ** | â­â­â­â­â­ (5/5) | å®Œæ•´é™çº§æœºåˆ¶         |
| **å“åº”å¼è®¾è®¡** | â­â­â­ (3/5)     | æœ‰æ–­ç‚¹ï¼Œç¼ºæ›¿ä»£ UI    |
| **è§¦æ‘¸é€‚é…**   | â­â­ (2/5)       | åŸºæœ¬æ”¯æŒï¼Œéœ€ä¼˜åŒ–     |
| **PWA æ”¯æŒ**   | â­â­â­â­ (4/5)   | å·²é…ç½®ï¼ŒåŠŸèƒ½å®Œæ•´     |
| **æ•´ä½“å…¼å®¹æ€§** | â­â­â­â­ (4/5)   | æ¡Œé¢ä¼˜ç§€ï¼Œç§»åŠ¨éœ€æ”¹è¿› |

**ä¸‹ä¸€æ­¥**: è¿›å…¥é˜¶æ®µä¸ƒ - ç”¨æˆ·ä½“éªŒæµ‹è¯•
